<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>å¤šå°å‡¯</title>
    <description>Front-end Developer.</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sat, 14 Nov 2020 01:19:49 +0800</pubDate>
    <lastBuildDate>Sat, 14 Nov 2020 01:19:49 +0800</lastBuildDate>
    <generator>Jekyll v3.6.0</generator>
    
      <item>
        <title>JavaScript äºŒè¿›åˆ¶ (ä¸Šç¯‡)</title>
        <description>&lt;h3 id=&quot;å‰æƒ…æè¦&quot;&gt;å‰æƒ…æè¦&lt;/h3&gt;
&lt;blockquote&gt;
  &lt;p&gt;åœ¨ JavaScript å¤„ç†äºŒè¿›åˆ¶æ•°æ®æ–¹é¢ä¸Šå¸¸æ¥è§¦çš„åªæœ‰ Node è¯»å†™æ–‡ä»¶çš„ Buffer å¯¹è±¡, è„‘æµ·ä¸­åªçŸ¥é“ ES6 ä¹Ÿæœ‰ ArrayBuffer ç›¸å…³çš„äºŒè¿›åˆ¶å¤„ç†çš„å¯¹è±¡, å…·ä½“ä¸¤è€…ä¹‹é—´æœ‰ä½•å…³ç³»åŠ ArrayBuffer çš„ç›¸å…³çŸ¥è¯†, è¿›é˜¶ç”¨æ³•éƒ½ç®—æ˜¯çŸ¥è¯†ç›²åŒºäº†, æ‰€ä»¥æ‰“ç®—è¿™æ¬¡å¥½å¥½æ¢³ç†å­¦ä¹ ä¸€ä¸‹, é¡ºä¾¿å†™ä¸ªåšå®¢è®°å½•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// æ‰«ç›²ä¹‹å‰ ğŸ˜‚
type ArrayBuffer = Array&amp;lt;Buffer&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;arraybuffer&quot;&gt;ArrayBuffer&lt;/h3&gt;
&lt;blockquote&gt;
  &lt;p&gt;2011 å¹´ 2 æœˆå‘å¸ƒ ArrayBuffer å¯¹è±¡ã€TypedArray è§†å›¾å’Œ DataView è§†å›¾æ˜¯ JavaScript æ“ä½œäºŒè¿›åˆ¶æ•°æ®çš„æ¥å£ã€‚è®© JavaScript æœ‰äº†æ“ä½œäºŒè¿›åˆ¶çš„èƒ½åŠ›, åé¢ ES6 å°†å®ƒä»¬çº³å…¥äº† ECMAScript è§„æ ¼ï¼Œå¹¶ä¸”å¢åŠ äº†æ–°çš„æ–¹æ³•ã€‚å®ƒä»¬éƒ½æ˜¯ä»¥æ•°ç»„çš„è¯­æ³•å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ‰€ä»¥ç»Ÿç§°ä¸ºäºŒè¿›åˆ¶æ•°ç»„ã€‚äº†è§£æ›´å¤šé˜…è¯» &lt;a href=&quot;https://es6.ruanyifeng.com/#docs/arraybuffer#&quot;&gt;ECMAScript 6 å…¥é—¨ ArrayBuffer&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;çŸ¥è¯†æ‘˜è¦&quot;&gt;çŸ¥è¯†æ‘˜è¦&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ArrayBufferå¯¹è±¡ï¼šä»£è¡¨å†…å­˜ä¹‹ä¸­çš„ä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ï¼Œå¯ä»¥é€šè¿‡â€œè§†å›¾â€è¿›è¡Œæ“ä½œã€‚â€œè§†å›¾â€éƒ¨ç½²äº†æ•°ç»„æ¥å£ï¼Œè¿™æ„å‘³ç€ï¼Œå¯ä»¥ç”¨æ•°ç»„çš„æ–¹æ³•æ“ä½œå†…å­˜ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;TypedArrayè§†å›¾ï¼šå…±åŒ…æ‹¬ 9 ç§ç±»å‹çš„è§†å›¾ï¼Œæ¯”å¦‚Uint8Arrayï¼ˆæ— ç¬¦å· 8 ä½æ•´æ•°ï¼‰æ•°ç»„è§†å›¾, Int16Arrayï¼ˆ16 ä½æ•´æ•°ï¼‰æ•°ç»„è§†å›¾, Float32Arrayï¼ˆ32 ä½æµ®ç‚¹æ•°ï¼‰æ•°ç»„è§†å›¾ç­‰ç­‰ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;DataViewè§†å›¾ï¼šå¯ä»¥è‡ªå®šä¹‰å¤åˆæ ¼å¼çš„è§†å›¾ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ Uint8ï¼ˆæ— ç¬¦å· 8 ä½æ•´æ•°ï¼‰ã€ç¬¬äºŒã€ä¸‰ä¸ªå­—èŠ‚æ˜¯ Int16ï¼ˆ16 ä½æ•´æ•°ï¼‰ã€ç¬¬å››ä¸ªå­—èŠ‚å¼€å§‹æ˜¯ Float32ï¼ˆ32 ä½æµ®ç‚¹æ•°ï¼‰ç­‰ç­‰ï¼Œæ­¤å¤–è¿˜å¯ä»¥è‡ªå®šä¹‰å­—èŠ‚åºã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;ä½¿ç”¨çš„ä¾‹å­&quot;&gt;ä½¿ç”¨çš„ä¾‹å­&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// TypedArray è§†å›¾
const buffer = new ArrayBuffer(12);
const x1 = new Int32Array(buffer);
x1[0] = 1;

// DataView è§†å›¾
const buf = new ArrayBuffer(32);
const dataView = new DataView(buf);
dataView.getUint8(0) // 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;å°ç»“&quot;&gt;å°ç»“&lt;/h4&gt;
&lt;blockquote&gt;
  &lt;p&gt;DataView è‡ªå®šä¹‰å¤åˆæ ¼å¼çš„è§†å›¾çš„æ¥å£æ›´åƒ Buffer, æˆ–è®¸ Buffer æ˜¯åŸºäºæ­¤å®ç°, å¦‚ä¸‹å¯ä»¥çœ‹çœ‹æ¥å£å¯¹æ¯”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// é˜…è¯»å®ŒåŸºç¡€çŸ¥è¯†å ğŸ¤”
DataView == Buffer ?

// DataView æ¥å£åˆ—è¡¨
- getInt8ï¼šè¯»å– 1 ä¸ªå­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ª 8 ä½æ•´æ•°ã€‚
- getUint8ï¼šè¯»å– 1 ä¸ªå­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ªæ— ç¬¦å·çš„ 8 ä½æ•´æ•°ã€‚
- getInt16ï¼šè¯»å– 2 ä¸ªå­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ª 16 ä½æ•´æ•°ã€‚
- getUint16ï¼šè¯»å– 2 ä¸ªå­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ªæ— ç¬¦å·çš„ 16 ä½æ•´æ•°ã€‚
- getInt32ï¼šè¯»å– 4 ä¸ªå­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ª 32 ä½æ•´æ•°ã€‚
- getUint32ï¼šè¯»å– 4 ä¸ªå­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ªæ— ç¬¦å·çš„ 32 ä½æ•´æ•°ã€‚
- getFloat32ï¼šè¯»å– 4 ä¸ªå­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ª 32 ä½æµ®ç‚¹æ•°ã€‚
- getFloat64ï¼šè¯»å– 8 ä¸ªå­—èŠ‚ï¼Œè¿”å›ä¸€ä¸ª 64 ä½æµ®ç‚¹æ•°ã€‚

- setInt8ï¼šå†™å…¥ 1 ä¸ªå­—èŠ‚çš„ 8 ä½æ•´æ•°ã€‚
- setUint8ï¼šå†™å…¥ 1 ä¸ªå­—èŠ‚çš„ 8 ä½æ— ç¬¦å·æ•´æ•°ã€‚
- setInt16ï¼šå†™å…¥ 2 ä¸ªå­—èŠ‚çš„ 16 ä½æ•´æ•°ã€‚

// Buffer æ¥å£åˆ—è¡¨
- buf.readDoubleBE([offset])
- buf.readDoubleLE([offset])
- buf.readFloatBE([offset])
- buf.readFloatLE([offset])
- buf.readInt8([offset])
- buf.readInt16BE([offset])
- buf.readInt16LE([offset])
- buf.readInt32BE([offset])
- buf.readInt32LE([offset])
- buf.readIntBE(offset, byteLength)
- buf.readIntLE(offset, byteLength)
- buf.readUInt8([offset])
- ...

- buf.writeDoubleBE(value[, offset])
- buf.writeDoubleLE(value[, offset])
- buf.writeFloatBE(value[, offset])
- ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;buffer&quot;&gt;Buffer&lt;/h3&gt;
&lt;h4 id=&quot;ä»£ç å®ç°&quot;&gt;ä»£ç å®ç°&lt;/h4&gt;
&lt;blockquote&gt;
  &lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç§ç§ Buffer çš„ä»£ç å®ç°äº†, Buffer å¯¹è±¡ç”± Buffer.form æ„é€ è€Œæˆï¼Œæ³¨æ„é€šè¿‡ new å…³é”®å­—æ„é€ ç”¨æ³•å·²ç»åºŸå¼ƒ, ä»¥ä¸‹ä»£ç åŸºäº &lt;a href=&quot;https://github.com/nodejs/node&quot;&gt;nodejs/node&lt;/a&gt;, version: 564fcb8&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// lib/buffer.js#290

Buffer.from = function from(value, encodingOrOffset, length) {
  if (typeof value === 'string')
    return fromString(value, encodingOrOffset);

  if (typeof value === 'object' &amp;amp;&amp;amp; value !== null) {
    if (isAnyArrayBuffer(value))
      return fromArrayBuffer(value, encodingOrOffset, length);
   
   ...   
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;ç®€åŒ–ä¸‹æ¥å‘ç°å·¥å‚æ¨¡å¼ Buffer.from æ–¹æ³•æœ€ç»ˆéƒ½æ˜¯è¿”å›äº†ä¸€ä¸ª FastBuffer å®ä¾‹&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Buffer.from(str[, encoding]) -&amp;gt; fromString -&amp;gt; new FastBuffer()
Buffer.from(arrayBuffer[, byteOffset[, length]]) -&amp;gt; fromArrayBuffer -&amp;gt; new FastBuffer()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// çœŸç›¸å¤§ç™½å ğŸ˜±
ğŸ‘‡ Buffer å°½ç„¶æ˜¯ Uint8Arrayï¼ˆæ— ç¬¦å· 8 ä½æ•´æ•°ï¼‰æ•°ç»„è§†å›¾ ğŸ‘‡
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// lib/internal/buffer.js#952
class FastBuffer extends Uint8Array {}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;é‚£ä¹ˆ Uint8Array çš„ Buffer æ˜¯å¦‚ä½•å®ç°è¯»å†™å…¶ä»– Int16ï¼Œ Uint16, Float32, Float64 æ¥å£ ? å»ç§ç§ 
buf.writeUInt16BE çš„å®ç°å§&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// lib/internal/buffer.js#828
function writeU_Int16BE(buf, value, offset, min, max) {
  value = +value;
  checkInt(value, min, max, buf, offset, 1);

  buf[offset++] = (value &amp;gt;&amp;gt;&amp;gt; 8); // æŒ‰ä½æ“ä½œç¬¦
  buf[offset++] = value;
  return offset;
}

function writeUInt16BE(value, offset = 0) {
  return writeU_Int16BE(this, value, offset, 0, 0xffff);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¿™é‡Œå…ˆç®€å•å›é¡¾ä¸€ä¸‹ &lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators&quot;&gt;JavaScript æŒ‰ä½æ“ä½œç¬¦&lt;/a&gt;, å¦‚ä¸Š valueÂ Â»&amp;gt; 8 æ˜¯å‘å³ç§»äº† 8ä½, æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸‹é¢æ•°å­—9(åè¿›åˆ¶)å‘å³ç§»åˆ°ä¸¤ä½çš„ä¾‹å­&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;     9 (base 10): 00000000000000000000000000001001 (base 2)
                  --------------------------------
9 &amp;gt;&amp;gt;&amp;gt; 2 (base 10): 00000000000000000000000000000010 (base 2) = 2 (base 10)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;å›åˆ° writeU_Int16BEï¼ŒåŸæ¥æ˜¯å†™ 16 ä½æ—¶, ä¼šé€šè¿‡å ç”¨ 2 ä¸ªå­—èŠ‚çš„å½¢å¼å„å­˜å‚¨ 8 ä½, ä¸¾ä¸ªä¾‹å­, å¦‚ 16 ä½çš„ 1000000000000000(32768), å¦‚ä¸Šçš„ä»£ç ç¬¬ä¸€ä¸ªå­—èŠ‚å­˜å‚¨çš„æ˜¯å‘å³ç§»äº† 8 ä½çš„ 10000000(128), ç¬¬äºŒä¸ªå­—èŠ‚ç›´æ¥èµ‹å€¼ç»™ 1000000000000000, ç¬¬äºŒä¸ªå­—èŠ‚è¶…å‡ºäº† 8 ä½æ€ä¹ˆåŠ ? è¶…å‡ºä¼šæˆªæ‰å¤´éƒ¨ ?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const b = new ArrayBuffer(2)

const v = new Uint8Array(b)
undefined
v[0] = 128
128
v[1] = 32768
32768
v
Uint8Array(2)Â [128, 0]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¦‚ä¸Šçš„ä»£ç è¿ç®—ä¹ŸéªŒè¯äº†çŒœæƒ³, ç¬¬äºŒä¸ªå­—èŠ‚å¤´éƒ¨è¶…å‡ºçš„ 8 ä½è¢«æˆªæ‰äº†ã€‚ åŸæ¥ Buffer å®ç°çš„å…¶ä»–ä½æ•°æ“ä½œæ¥å£éƒ½æ˜¯è¢«ä¿®é¥°æŠ¹å¹³åçš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;å­—èŠ‚åº&quot;&gt;å­—èŠ‚åº&lt;/h4&gt;
&lt;blockquote&gt;
  &lt;p&gt;ä»”ç»†å‘ç° Buffer æ¯” DataView å¤šäº†ä¸€äº›æ¥å£, æ¯”å¦‚æœ‰ &lt;strong&gt;&lt;em&gt;å­—èŠ‚åº&lt;/em&gt;&lt;/strong&gt; çš„æ¦‚å¿µ, å¦‚ buf.writeInt32BE, buf.writeInt32LE, DataView åªæœ‰ setInt32&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;è®¡ç®—æœºç¡¬ä»¶æœ‰ä¸¤ç§å‚¨å­˜æ•°æ®çš„æ–¹å¼ï¼šå¤§ç«¯å­—èŠ‚åºï¼ˆbig endianï¼‰å’Œå°ç«¯å­—èŠ‚åºï¼ˆlittle endianï¼‰ã€‚
ä¸¾ä¾‹æ¥è¯´ï¼Œæ•°å€¼0x2211ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚å‚¨å­˜ï¼šé«˜ä½å­—èŠ‚æ˜¯0x22ï¼Œä½ä½å­—èŠ‚æ˜¯0x11ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;å¤§ç«¯å­—èŠ‚åºï¼šé«˜ä½å­—èŠ‚åœ¨å‰ï¼Œä½ä½å­—èŠ‚åœ¨åï¼Œè¿™æ˜¯äººç±»è¯»å†™æ•°å€¼çš„æ–¹æ³•ã€‚
å°ç«¯å­—èŠ‚åºï¼šä½ä½å­—èŠ‚åœ¨å‰ï¼Œé«˜ä½å­—èŠ‚åœ¨åï¼Œå³ä»¥0x1122å½¢å¼å‚¨å­˜ã€‚
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;æˆ‘çš„ç†è§£æ˜¯ç”¨é«˜å­—èŠ‚å†™å°±ç”¨é«˜å­—èŠ‚è¯», ä½å­—èŠ‚å†™å°±ç”¨é«˜ä½å­—èŠ‚è¯»å°±è¡Œ, ä¸ç„¶å­˜å‚¨çš„ AB, è¯»å‡ºæ¥çš„æ˜¯ BA ã€‚äº†è§£æ›´å¤šé˜…è¯» &lt;a href=&quot;http://www.ruanyifeng.com/blog/2016/11/byte-order.html&quot;&gt;ç†è§£å­—èŠ‚åº&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;ä½¿ç”¨åœºæ™¯&quot;&gt;ä½¿ç”¨åœºæ™¯&lt;/h3&gt;
&lt;blockquote&gt;
  &lt;p&gt;åœ¨æµè§ˆå™¨ç«¯æ“ä½œäºŒè¿›åˆ¶ä¼šæ¯”è¾ƒå°‘è§, è¿™ä¸ Webpack v5 å‘å¸ƒä¸ä¹…, è¿™é‡Œè¿˜æ˜¯è®²è®² Node ä¸Šçš„å®è·µ, å…¶ä¸­ Webpack v5 çš„ &lt;strong&gt;&lt;em&gt;æœ¬åœ°æŒä¹…ç¼“å­˜&lt;/em&gt;&lt;/strong&gt; åŠŸèƒ½é‡ŒäºŒè¿›åˆ¶ç›¸å…³çš„æ“ä½œæ˜¯å¯ä»¥å¥½å¥½å­¦ä¸€ä¸‹çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¦‚ä½•é€šä¿—çš„è§£é‡Šè¿™ä¸ªåŠŸèƒ½ç‚¹äº†? å¤§å®¶çŸ¥é“é¦–æ¬¡ç¼–è¯‘å, ä¿®æ”¹ä»£ç åå†æ¬¡çš„ç¼–è¯‘è€—æ—¶æ˜¯éå¸¸çŸ­çš„, è¿™æ˜¯ MemoryCachePlugin çš„åŠŸèƒ½, å®ƒèƒ½åœ¨ç¼–è¯‘åæŠŠéœ€è¦éƒ½æ•°æ®éƒ½ç¼“å­˜åœ¨å†…å­˜ä¸­, æ¥ä¸‹æ¥çš„ç¼–è¯‘å½“æ–‡ä»¶çš„æ—¶é—´æˆ³æ²¡æœ‰å˜åŒ–éƒ½æ˜¯ç›´æ¥è¿”å›ä¸Šä¸€æ¬¡çš„è¿è¡Œç»“æœã€‚åœ¨ä¸€ä¸ªè¿è¡Œæ—¶é‡Œé¢å¾€å†…å­˜è¯»å–æ•°æ®è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„, å†…å­˜ç¼“å­˜ç›¸å…³çš„è¿™ä¸€ç‚¹å°±ç»†ä¸è¯´äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;é‚£ä¹ˆå¦‚ä½•ç†è§£ IdleFileCachePlugin å®ç°çš„æŒä¹…ç¼“å­˜åŠŸèƒ½? ç®€å•è¯´å°±æ˜¯æŠŠæœ¬æ¬¡çš„ç¼–è¯‘çš„æ•°æ®å†™å…¥æ–‡ä»¶ä¸­, å½“æœ¬æ¬¡ç¼–è¯‘ç»“æŸè¿›ç¨‹é€€å‡º, åé¢é‡æ–° npm start çš„æ—¶å€™åœ¨ä¼šä»ç¼“å­˜æ–‡ä»¶ä¸­æŠŠå„ä¸ªæ¨¡å—ä¸Šæ¬¡ç¼–è¯‘ç»“æœè¯»å–å‡ºæ¥ä»¥æ­¤æ¥å‡å°‘å¤§é‡çš„ç¼–è¯‘æ—¶é—´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¤§é‡çš„æ–‡ä»¶æ“ä½œå½“ç„¶æ˜¯ç›´æ¥æ“ä½œäºŒè¿›åˆ¶æ¯”è¾ƒå¿«, å¯¹äº JavaScript çš„ 5 ç§åŸºæœ¬æ•°æ®ç±»å‹ Undefinedã€Nullã€Booleanã€Numberã€String ä»¥åŠå¤æ‚çš„æ•°æ®ç±»å‹ Object çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–, ä»£ç å‹ç¼©ç­‰ Webpack åšçš„å„ç§ç­–ç•¥è¿˜æ˜¯èƒ½å¥½å¥½è®²è§£ä¸€ä¸‹çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¿™éƒ¨åˆ†çš„ä»£ç è®²è§£å°±æ”¾åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« å§ â€¦&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://timgsa.baidu.com/timg?image&amp;amp;quality=80&amp;amp;size=b9999_10000&amp;amp;sec=1605297615876&amp;amp;di=a8600be2381d57666a014d9b63692976&amp;amp;imgtype=0&amp;amp;src=http%3A%2F%2Fpic4.zhimg.com%2F50%2Fv2-48f30f9964e3207b7c45aa54428e803b_hd.jpg&quot; alt=&quot;ä¸‹æ¬¡è§ï½&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;å…³äºæœ¬ç¯‡æ–‡ç« ä½œè€…ç†è§£æœ‰è¯¯æˆ–å…¶ä»–è®¨è®º &lt;a href=&quot;https://github.com/xiaoxiaojx/blog/issues&quot;&gt;Issues&lt;/a&gt; è§ ~&lt;/p&gt;
&lt;/blockquote&gt;

</description>
        <pubDate>Wed, 04 Nov 2020 14:32:24 +0800</pubDate>
        <link>http://localhost:4000/2020/11/javascripts-binary-1/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/11/javascripts-binary-1/</guid>
        
        
      </item>
    
      <item>
        <title>Snowpack æ›´å¿«çš„å‰ç«¯æ„å»ºå·¥å…·</title>
        <description>&lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;æœ€è¿‘å¯¹è„šæ‰‹æ¶æŠ€æœ¯æ¶æ„çš„å‡çº§æ”¹é€ , è™½ç„¶åœ¨æ„å»ºé€Ÿåº¦æ–¹é¢æå‡äº†3+å€, æ¥å…¥é¡¹ç›®çš„å¤§ä½¬ä»¬ä¹Ÿéƒ½ç”šä¸ºæ»¡æ„, æ¯•ç«Ÿè¿˜æ˜¯æ²¡èƒ½è¾¾åˆ°ç§’çº§çš„å¼€å‘ä½“éªŒã€‚æƒ³ç€è¿™ç®—åˆ°äº† webpack çš„ç“¶é¢ˆäº†, è¦å»è°ƒç ”æ›´å¿«çš„æ‰“åŒ…å·¥å…·åŠè½åœ°çš„å¯èƒ½æ€§äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ç°çŠ¶&quot;&gt;ç°çŠ¶&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;æ–°çš„è„šæ‰‹æ¶å¯¹ webpack çš„æ„å»ºé€Ÿåº¦ä¼˜åŒ–ç®€è¿°ä¸ºä»¥ä¸‹å‡ ç‚¹, åé¢å¯ä»¥å•ç‹¬å±•å¼€åˆ†äº«ä¸€ä¸‹&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ol&gt;
  &lt;li&gt;å¤šçº¿ç¨‹&lt;/li&gt;
  &lt;li&gt;å‰ç½®æ„å»º&lt;/li&gt;
  &lt;li&gt;å¤šé¡µé¢åŠ¨æ€ç¼–è¯‘/&lt;a href=&quot;https://github.com/xiaoxiaojx/dynamic-routes-webpack-plugin&quot;&gt;å•é¡µå¤šè·¯ç”±åŠ¨æ€ç¼–è¯‘&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;loaderç¼“å­˜/pluginç¼“å­˜&lt;/li&gt;
  &lt;li&gt;æŒä¹…ç¼“å­˜&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;å‚èµ›å·¥å…·&quot;&gt;å‚èµ›å·¥å…·&lt;/h2&gt;

&lt;h3 id=&quot;parcel&quot;&gt;Parcel&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4aed5ca8aa1e4163b663888cf9bc9f68~tplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;å…¶å®ä¸€ç›´æ˜¯å†™ demo çš„é¦–é€‰, è¯´è¦è½åœ°åˆ°ç”Ÿäº§, æ²¡æƒ³è¿‡ â€¦ å®˜ç½‘ä¸Šå®£ä¼ çš„é€Ÿåº¦åªæ˜¯ webpack çš„ä¸¤å€å·¦å³, åŠ ä¸Šä»…å­˜çš„ä¸‰ä¸¤é¡¹ç›®é‡åˆ°çš„ä¸€äº› bug(é™†ç»­ä¹Ÿè½¬åˆ°äº† webpack), ç®—ä¸Šç¤¾åŒºçš„æ´»è·ƒåº¦ï¼Œæ²¡æœ‰å®è·µçš„åŠ¨åŠ›ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¯¹ parcel çš„è¯„ä¼°åªæ˜¯ä¸ªäººçš„ç»éªŒ, ç¼ºä¹æ•°æ®è¯´æ˜ã€‚è¯è¯´å›æ¥å³ä½¿æ˜¯ç¨³å®šä¸”å¥å£®çš„ parcel ä¹Ÿæ˜¯è¾¾ä¸åˆ°æˆ‘ä»¬æœ€åˆçš„ç§’çº§çš„å¼€å‘ä½“éªŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;å°ç»“-parcel-ä»ç„¶ä¸é€‚åˆä¸­å¤§å‹é¡¹ç›®&quot;&gt;å°ç»“: parcel ä»ç„¶ä¸é€‚åˆä¸­å¤§å‹é¡¹ç›®ã€‚&lt;/h4&gt;

&lt;h3 id=&quot;snowpack&quot;&gt;Snowpack&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abec98eb1c554e328b807d9a3b684dd8~tplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;ç»ˆäºå›åˆ°äº†æœ¬æ¬¡çš„ä¸»é¢˜, ä¸ºä»€ä¹ˆè¯´ snowpack å¿« ? å®ƒæ˜¯å¸Œæœ›ä½ èƒ½å†™å‡ºæµè§ˆå™¨ç›´æ¥èƒ½è¿è¡Œçš„ä»£ç , ä½ è¯´å®ƒèƒ½ä¸å¿«å— â€¦ å½“ç„¶è¿˜æ˜¯è¦æœ‰ç†æœ‰æ®, çœ‹çœ‹å®˜æ–¹è§£é‡Šã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&quot;snowpack-leverages-javascripts-native-module-system-known-as-esm-to-create-a-first-of-its-kind-build-system-that-never-builds-the-same-file-twice-snowpack-pushes-changes-instantly-to-the-browser-saving-you-hours-of-development-time-traditionally-spent-waiting-around-for-your-bundler&quot;&gt;Snowpack leverages JavaScriptâ€™s native module system (known as ESM) to create a first-of-its-kind build system that never builds the same file twice. Snowpack pushes changes instantly to the browser, saving you hours of development time traditionally spent waiting around for your bundler.&lt;/h5&gt;

&lt;h4 id=&quot;ä¸»è¦å¸®æˆ‘ä»¬åšäº†ä»€ä¹ˆ&quot;&gt;ä¸»è¦å¸®æˆ‘ä»¬åšäº†ä»€ä¹ˆ&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 1. æŠŠé¡¹ç›®ä¾èµ–çš„ node_modules æ¨¡å—é€šè¿‡ rollup ç¼–è¯‘æˆ esm æ ‡å‡†ä»£ç è¾“å‡ºåˆ° 
build/web_modules ç›®å½•

# snowpack/src/commands/dev.ts#297

// å¦‚æœæ˜¯ä¸å­˜åœ¨ 'package-lock.json' æˆ–è€… 'yarn.lock'|| 'package-lock.json' æˆ–è€… 'yarn.lock' æœ‰å˜åŒ– || ç¬¬ä¸€æ¬¡æ„å»º ç­‰æƒ…å†µä¼šé‡æ–°ç¼–è¯‘
if (!(await checkLockfileHash(DEV_DEPENDENCIES_DIR)) || !existsSync(dependencyImportMapLoc)) {
// ...
}

# 2. é€šè¿‡ babel ç¼–è¯‘ ts, tsx, js, jsx ä»£ç è¾“å‡ºåˆ° build/_dist_ ç›®å½•(æ¯•ç«Ÿæµè§ˆå™¨è·‘ä¸äº† jsx, ts ä»£ç )

# plugins/plugin-babel/worker.js#4

async function transformFileAsync(path, options) {
  const {code, map} = await babel.transformFileAsync(path, options);
  return JSON.stringify({code, map});
}

// ä½¿ç”¨å¦‚ä¸‹æ–‡ä»¶çš„ babel é…ç½®
# app-scripts-react/babel.config.json

// å®è·µè¯æ˜ @babel/preset-typescript å‘ä¸å°‘, è€é¡¹ç›®ä¸Šçº¿å‡ ä¸ªç™½å±å‡ ä¸ª
{
  &quot;presets&quot;: [[&quot;@babel/preset-react&quot;], &quot;@babel/preset-typescript&quot;],
  &quot;plugins&quot;: [&quot;@babel/plugin-syntax-import-meta&quot;],
  &quot;env&quot;: {
    &quot;development&quot;: {
      &quot;plugins&quot;: [
        &quot;react-refresh/babel&quot;
      ]
    }
  }
}

# 3. å¼€å‘ç¯å¢ƒå¯åŠ¨ä¸€ä¸ª devServer

# snowpack/src/commands/dev.ts#875

const server = createServer((req, res) =&amp;gt; {
// ...
})

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;demo-ç›®å½•ç»“æ„å¯¹æ¯”&quot;&gt;demo ç›®å½•ç»“æ„å¯¹æ¯”&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;âœ  new-dir tree src
src
â”œâ”€â”€ App.css
â”œâ”€â”€ App.jsx
â”œâ”€â”€ App.test.jsx
â”œâ”€â”€ index.css
â”œâ”€â”€ index.jsx
â”œâ”€â”€ logo.svg
â””â”€â”€ test.css

âœ  new-dir tree build
build
â”œâ”€â”€ __snowpack__
â”‚   â””â”€â”€ env.js
â”œâ”€â”€ _dist_
â”‚   â”œâ”€â”€ App.css
â”‚   â”œâ”€â”€ App.js
â”‚   â”œâ”€â”€ index.css
â”‚   â”œâ”€â”€ index.css.proxy.js
â”‚   â”œâ”€â”€ index.js
â”‚   â”œâ”€â”€ logo.svg
â”‚   â”œâ”€â”€ logo.svg.proxy.js
â”‚   â””â”€â”€ test.css
â”œâ”€â”€ favicon.ico
â”œâ”€â”€ index.html
â”œâ”€â”€ robots.txt
â””â”€â”€ web_modules
    â”œâ”€â”€ import-map.json
    â””â”€â”€ react-dom.js
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;å‘ç°çš„ä¸€äº›é—®é¢˜&quot;&gt;å‘ç°çš„ä¸€äº›é—®é¢˜&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;æºç å¯èƒ½ä¼šè¢«ç¯¡æ”¹&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# plugins/plugin-babel/plugin.js#42

code = code.replace(/process\.env/g, 'import.meta.env');

// ä¼šé€ æˆå¦‚ä¸‹é—®é¢˜

// src
function getEnvLabel() {
 return 'process.env.NODE_ENV'
}
// dist
function getEnvLabel() {
 return 'import.meta.env'
}

// enum ....
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;css æ–‡ä»¶ @import å¦ä¸€ä¸ª css æ–‡ä»¶ä¸ä¼šå¤„ç†
    &lt;blockquote&gt;
      &lt;p&gt;æ²¡æœ‰è¿›è¡Œ ast è¯­æ³•åˆ†æ, ä½ åªèƒ½åœ¨ js æ–‡ä»¶é‡Œé¢ import, ä¹Ÿè®¸ä½ æƒ³ç€å¸®å¿™ä¸€èµ·å®Œå–„è¿™å—, åˆ°äº†æ—¥è¶‹å®Œå–„çš„ä¸€å¤©å‘ç°ä¹‹å‰ä¸å°±æœ‰ä¸€ä¸ªæˆç†Ÿçš„ webpack ä¸ºä½•ä¸ç”¨ ? è¿™ â€¦&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;â€¦.&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;å°ç»“&quot;&gt;å°ç»“&lt;/h4&gt;
&lt;blockquote&gt;
  &lt;p&gt;ç°åœ¨çš„ snowpack è¿˜æ˜¯å¸Œæœ›ä½ èƒ½å†™å‡ºæµè§ˆå™¨ç›´æ¥èƒ½è¿è¡Œçš„ä»£ç , å¯¹äºæ–°å°é¡¹ç›®å¼€å‘ç¯å¢ƒå¯å°è¯•, å…¶ä»–è¿˜æ˜¯å…ˆç­‰ä¸€ç­‰ â€¦&lt;/p&gt;
&lt;/blockquote&gt;

</description>
        <pubDate>Tue, 29 Sep 2020 14:32:24 +0800</pubDate>
        <link>http://localhost:4000/2020/09/snowpack/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/09/snowpack/</guid>
        
        
      </item>
    
      <item>
        <title>React, TypeScript å†™æ¸¸æˆæ¢ç´¢</title>
        <description>&lt;h3 id=&quot;ç®€å•ä»‹ç»&quot;&gt;ç®€å•ä»‹ç»&lt;/h3&gt;
&lt;h4 id=&quot;æ¸¸æˆæŒ‰é”®å¦‚ä¸‹å›¾&quot;&gt;æ¸¸æˆæŒ‰é”®å¦‚ä¸‹å›¾&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;https://pic2.zhimg.com/80/v2-1c2f1967b8bb694a8c2fc0083d73d3ea_hd.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;é¡¶è¿™ä¸ªå¢™å‡ºç°è˜‘è‡-æ­¤è˜‘è‡æ¥äº†æ‰å¯ä»¥å‘å­å¼¹&quot;&gt;é¡¶è¿™ä¸ªå¢™å‡ºç°è˜‘è‡, æ­¤è˜‘è‡æ¥äº†æ‰å¯ä»¥å‘å­å¼¹&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;https://pic1.zhimg.com/80/v2-b0397d7642f871fe3bc1f197f9edd6fd_hd.jpg&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;react-å†™æ¸¸æˆçš„ä¸€äº›å¿ƒå¾—&quot;&gt;React å†™æ¸¸æˆçš„ä¸€äº›å¿ƒå¾—&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://d3hp955ol7sp5f.cloudfront.net/ReactJSstatic/images/webpack/b736f282b84b3f116be4319681af8b94.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;1-reactçš„ä¼˜åŠ¿&quot;&gt;1. Reactçš„ä¼˜åŠ¿&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;æ•°æ®é©±åŠ¨&lt;/strong&gt;, æ ¹æ®stateæˆ–è€…propsçš„å˜åŒ– =&amp;gt; è§†å›¾çš„å˜åŒ–, ä»¥å‰çš„æ–¹å¼å¾€å¾€æ˜¯ç›´æ¥æ“ä½œ DOM å®ç°, è§¦å‘æŸäº‹ä»¶ä½¿å¾—å…ƒç´ ç§»åŠ¨ä»£ç ç±»ä¼¼å¦‚:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    moveRight() {
        this.left += 8;
        this.draw();
    }

    draw() {
        if(this.ele === null){
            this.ele = document.createElement('img');
            this.ele.src = this.url;
            this.ele.style.width = this.width + 'px';
            this.ele.style.height = this.height + 'px';
            this.ele.style.position = 'absolute';
            app.appendChild(this.ele);
        }
        this.ele.style.left = this.left + 'px';
        this.ele.style.top = this.top + 'px';
    };
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;ç°åœ¨å°±å‹å¥½å¾ˆå¤š&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    moveRight() {
        this.setState( preState =&amp;gt; (
            {
                left: preState.left + 8
            }
        ));
    }

    &amp;lt;ContraBG
        left={left}
        top={top}
        status={status}
        toward={toward}&amp;gt;
    &amp;lt;/ContraBG&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ç»“æ„æ›´æ¸…æ™°&lt;/strong&gt;, é€ä¸ªä¹¦å†™éœ€è¦æ¸²æŸ“çš„ç»„ä»¶, èƒ½è®©äººä¸€ç›®äº†ç„¶çš„çŸ¥é“æ¸¸æˆè¿è¡Œä¸­åŠ è½½çš„ç»„ä»¶, è€çš„æ–¹å¼ä»£ç é£æ ¼å»æ¸²æŸ“ä¸€ä¸ªå…ƒç´ å¦‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    const contra = new Contra();
    const bulletsMap = new BulletsMap();
    const enemiesMap = new EnemiesMap();
    contra.draw();
    bulletsMap.draw();
    enemiesMap.draw();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;å¦‚æœæ¸²æŸ“çš„å¤šäº†ç»“æ„å¤æ‚äº†,é˜…è¯»å°±ä¼šååˆ†å›°éš¾ã€‚ç°åœ¨çš„ä»£ç é£æ ¼å°±èƒ½å¤Ÿä¸€ç›®äº†ç„¶çš„çœ‹åˆ°æ‰€æœ‰è¿è¡Œçš„ç»„ä»¶&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;=&amp;gt;
    @observer
    class InGame extends React.PureComponent&amp;lt;InGameProps, {}&amp;gt; {
        render() {
            const { store } = this.props;
    
            return (
                &amp;lt;InGameBG   // åŒ…è£¹ç»„ä»¶è´Ÿè´£æ¸²æŸ“èƒŒæ™¯å˜åŒ–ç›¸å…³
                        store={store}&amp;gt;
                        &amp;lt;Contra // ç©å®¶æ§åˆ¶çš„è§’è‰²ç»„ä»¶
                            store={store}/&amp;gt;
                        &amp;lt;BulletsMap // è´Ÿè´£æ¸²æŸ“å­å¼¹
                            store={store}/&amp;gt;
                        &amp;lt;EnemiesMap // è´Ÿè´£æ¸²æŸ“æ•Œæ–¹è§’è‰²
                            store={store}/&amp;gt;
                &amp;lt;/InGameBG&amp;gt;
            );
        }
    }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-reactçš„åŠ£åŠ¿&quot;&gt;2. Reactçš„åŠ£åŠ¿&lt;/h3&gt;
&lt;blockquote&gt;
  &lt;p&gt;å‰è€…ç±»ä¸ç±»ä¹‹é—´ç»§æ‰¿ä¼šçµæ´»å¾ˆå¤š, å¦‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    é£æœºç»§æ‰¿è‡³é£è¡Œç‰© =&amp;gt; é£è¡Œç‰©ç»§æ‰¿è‡³åŠ¨æ€ç‰© =&amp;gt; åŠ¨æ€ç‰©ç»§æ‰¿è‡³æŸä¸€ç‰¹æ€§ç‰©ä½“
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;React ä¸æ¨å´‡ç»§æ‰¿, å¯é‡‡ç”¨ç»„åˆ, HOCé«˜é˜¶ç»„ä»¶æ€æƒ³å»æ¸²æŸ“ä¸€ç³»åˆ—å…·æœ‰ç›¸ä¼¼æ€§è´¨çš„ç»„ä»¶ã€‚å¦‚è¶…çº§ç›ä¸½æ¸¸æˆä¸­æœ‰è®¸å¤šçš„å¢™,å®ƒä»¬å…·æœ‰ç›¸ä¼¼çš„æ¸²æŸ“é€»è¾‘,ä»¥åŠä¸€äº›éƒ½ä¼šéœ€è¦ç”¨åˆ°çš„æ–¹æ³•, å¯ä»¥é€šè¿‡å†™ä¸€ä¸ªé™æ€æ–¹å—çš„é«˜é˜¶ç»„ä»¶å»ç”Ÿæˆ, èƒ½å¤Ÿæ›´é«˜æ•ˆçš„ç®¡ç†ä»£ç ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    function WithStaticSquare&amp;lt;TOwnProps&amp;gt;(options: StaticSquareOption):ComponentDecorator&amp;lt;TOwnProps&amp;gt; {
        return Component =&amp;gt;
            class HocSquare extends React.Component&amp;lt;TOwnProps, HocSquareState&amp;gt; {
                // xxx
                render() {
                    const { styles, className } = this.state;
                    const passThroughProps: any = this.props;
                    const classNames = className ? `staticHocWrap ${className}` : &quot;staticHocWrap&quot;;
    
    
                    const staticProps: WrappedStaticSquareUtils = {
                        changeBackground: this.changeBackground,
                        toTopAnimate: this.toTopAnimate
                    };  // æä¾›ä¸€äº›å¯èƒ½ä¼šç”¨åˆ°çš„æ”¹å˜èƒŒæ™¯å›¾çš„æ–¹æ³•ä»¥åŠè¢«æ’æ—¶è°ƒç”¨å‘ä¸ŠåŠ¨ç”»çš„æ–¹æ³•
    
                    return (
                        &amp;lt;div
                            className={classNames}
                            style={styles}&amp;gt;
                            &amp;lt;Component
                                hoc={staticProps}
                                {...passThroughProps}/&amp;gt;
                        &amp;lt;/div&amp;gt;
                    );
                }
            }
    }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3-æ€§èƒ½é—®é¢˜&quot;&gt;3. æ€§èƒ½é—®é¢˜&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é¿å…å¡é¡¿&lt;/strong&gt; å‰è€…ç›´æ¥æ“ä½œæŸä¸ªDOMæ¸²æŸ“ä¸ä¼šæœ‰å¤ªå¤šå¡é¡¿ç°è±¡å‘ç”Ÿ
Reactä½¿ç”¨Mobx, Reduxç­‰è¿›è¡Œæ•´ä¸ªæ¸¸æˆæ•°æ®æ§åˆ¶æ—¶, å¦‚æœä¸å¯¹æ¸²æŸ“è¿›è¡Œä¼˜åŒ–, å½“storeæŸä¸ªå±æ€§å€¼å˜åŒ–å¯¼è‡´æ‰€æœ‰æ¥å…¥propsçš„ç»„ä»¶éƒ½é‡æ–°æ¸²æŸ“ä¸€æ¬¡ä»£ä»·æ˜¯å·¨å¤§çš„!
    &lt;ol&gt;
      &lt;li&gt;é‡‡ç”¨ PureComponent æˆ–è€…ä¸º Component åŠ å…¥ shouldComponentUpdate&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    class Square extends React.PureComponent&amp;lt;SquareProps, {}&amp;gt; {
        // xxx
    }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;å…¶ä¸­å°±éœ€è¦äº†è§£PureComponentã€‚React.PureComponentæ˜¯2016.06.29 React 15.3ä¸­å‘å¸ƒã€‚&lt;img src=&quot;http://p5.qhimg.com/t0131e05b31c1284209.gif&quot; alt=&quot;image&quot; /&gt;
PureComponentæ”¹å˜äº†ç”Ÿå‘½å‘¨æœŸæ–¹æ³•shouldComponentUpdateï¼Œå¹¶ä¸”å®ƒä¼šè‡ªåŠ¨æ£€æŸ¥ç»„ä»¶æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“ã€‚è¿™æ—¶ï¼Œåªæœ‰PureComponentæ£€æµ‹åˆ°stateæˆ–è€…propså‘ç”Ÿå˜åŒ–æ—¶ï¼ŒPureComponentæ‰ä¼šè°ƒç”¨renderæ–¹æ³•,ä½†æ˜¯è¿™ç§æ£€æŸ¥åªæ˜¯æµ…è®¡è¾ƒè¿™å°±æ„å‘³ç€åµŒå¥—å¯¹è±¡å’Œæ•°ç»„æ˜¯ä¸ä¼šè¢«æ¯”è¾ƒçš„&lt;a href=&quot;https://60devs.com/pure-component-in-react.html&quot;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ol&gt;
  &lt;li&gt;å¤šé‡‡ç”¨ç»„ä»¶å»æ¸²æŸ“, å¯¹æ¯”ä¸¤ç§æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    // æ–¹æ³•1.
    &amp;lt;InGameBG   // åŒ…è£¹ç»„ä»¶è´Ÿè´£æ¸²æŸ“èƒŒæ™¯å˜åŒ–ç›¸å…³
            store={store}&amp;gt;
            &amp;lt;Contra // ç©å®¶æ§åˆ¶çš„è§’è‰²ç»„ä»¶
                store={store}/&amp;gt;
            &amp;lt;BulletsMap // è´Ÿè´£æ¸²æŸ“å­å¼¹
                store={store}/&amp;gt;
            &amp;lt;EnemiesMap // è´Ÿè´£æ¸²æŸ“æ•Œæ–¹è§’è‰²
                store={store}/&amp;gt;
    &amp;lt;/InGameBG&amp;gt;
    //æ–¹æ³•2.
    &amp;lt;InGameBG
        store={store}&amp;gt;
            &amp;lt;Contra
                store={store}/&amp;gt;
            &amp;lt;div&amp;gt;
                {
                    bulletMap.map((bullet, index) =&amp;gt; {
                    if ( bullet ) {
                        return (
                            &amp;lt;Bullet
                                key={`Bullet-${index}`}
                                {...bullet}
                                index={index}
                                store={store}/&amp;gt;
                        );
                    }
                    return null;
                })
                }
            &amp;lt;/div&amp;gt;
            &amp;lt;EnemiesMap
                store={store}/&amp;gt;
    &amp;lt;/InGameBG&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¿™ä¸¤ç§æ–¹æ³•çš„åŒºåˆ«å°±æ˜¯åœ¨äºæ¸²æŸ“å­å¼¹æ˜¯å¦é€šè¿‡ç»„ä»¶æ¸²æŸ“è¿˜æ˜¯åœ¨çˆ¶ç»„ä»¶ä¸­ç›´æ¥æ¸²æŸ“, å…¶ä¸­æ–¹æ³•2çš„æ€§èƒ½ä¼šæœ‰å¾ˆå¤§çš„é—®é¢˜, å½“æŸä¸ªå­å¼¹å˜åŒ–æ—¶ä½¿å¾—æœ€å¤§çš„å®¹å™¨é‡æ–°æ¸²æŸ“, å…¶ä¸­æ‰€æœ‰å­ç»„ä»¶ä¹Ÿä¼šå»åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œä½¿å¾—ç•Œé¢ä¼šå‡ºç°å¡é¡¿ã€‚è€Œæ–¹æ³•1åˆ™åªä¼šåœ¨å‘ç”Ÿæ•°æ®å˜åŒ–çš„å­å¼¹å»æ¸²æŸ“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ol&gt;
  &lt;li&gt;getLazyLoadMap å¯¹åœ°å›¾çš„å®æ—¶åˆ‡å‰²æ¸²æŸ“(éå¸¸é‡è¦!!!)&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const LIMIT: number = 16;
const GAME_WIDTH: number = 512;

@observer
class SquaresMap extends React.PureComponent&amp;lt;SquaresMapProps, {}&amp;gt; {
    getLazyLoadMap() {
        const { staticSquareMap, inGameGBLeft } = this.props.store;
        const OFFSET = Math.abs(inGameGBLeft) / GAME_WIDTH * LIMIT;
        return staticSquareMap.reduce((preVal, currentVal) =&amp;gt; {
            const items = [...currentVal];
            const current = items.splice(OFFSET, LIMIT);
            preVal.push(current);
            return preVal;
        }, [] as StaticSquareManagementType[][]);
    }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;4-éœ€è¦æ³¨æ„çš„ç‚¹&quot;&gt;4. éœ€è¦æ³¨æ„çš„ç‚¹&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;åŠæ—¶ç§»é™¤ç›‘å¬&lt;/strong&gt;, åœ¨ç»„ä»¶å¸è½½æ—¶éœ€è¦ç§»é™¤è¯¥ç»„ä»¶çš„äº‹ä»¶ç›‘å¬, æ—¶é—´å‡½æ•°ç­‰ã€‚å¦‚æ¸¸æˆå¼€å§‹ç»„ä»¶&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    class GameStart extends React.Component&amp;lt;GameStartProps, {}&amp;gt; {
        constructor(props) {
            super(props);
    
            this.onkeydownHandle = this.onkeydownHandle.bind(this);
        }
        componentDidMount() {
            this.onkeydown();
        }
        componentWillUnmount() {
            this.destroy();
        }
        destroy(): void {
            console.log(&quot;æ¸¸æˆå¼€å§‹! GameStart Component destroy ....&quot;);
            window.removeEventListener(&quot;keydown&quot;, this.onkeydownHandle);
        }
        onkeydownHandle(e: KeyboardEvent): void {
            const keyCode: KeyCodeType = e.keyCode;
            const {  store } = this.props;
            const { updateGameStatus } = store;
            switch ( keyCode ) {
                case 72:
                    updateGameStatus(1);
                    break;
            }
        }
        onkeydown(): void {
            window.addEventListener(&quot;keydown&quot;, this.onkeydownHandle);
        }
        render() {
            return (
                &amp;lt;div className=&quot;gameStartWrap&quot;&amp;gt;
                &amp;lt;/div&amp;gt;
            );
        }
    }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Wed, 30 Aug 2017 14:32:24 +0800</pubDate>
        <link>http://localhost:4000/2017/08/super-contra/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/super-contra/</guid>
        
        
      </item>
    
  </channel>
</rss>
